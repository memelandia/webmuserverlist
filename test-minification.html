<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Minificaci√≥n - Comparaci√≥n de Rendimiento</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            padding: 20px; 
            background: #0f0f0f; 
            color: #fff; 
            line-height: 1.6;
        }
        .container { max-width: 1200px; margin: 0 auto; }
        .comparison-section { 
            background: #1a1a1a; 
            padding: 20px; 
            border-radius: 8px; 
            margin: 20px 0; 
            border: 1px solid #333;
        }
        .comparison-title { 
            color: #ff3333; 
            margin-bottom: 15px; 
            font-size: 1.3em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        .comparison-item {
            background: #252525;
            padding: 15px;
            border-radius: 6px;
            border: 1px solid #333;
        }
        .comparison-item h4 {
            color: #ff3333;
            margin-bottom: 10px;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        .stat-item {
            background: #333;
            padding: 15px;
            border-radius: 6px;
            text-align: center;
        }
        .stat-number {
            font-size: 1.8em;
            font-weight: bold;
            color: #ff3333;
        }
        .stat-label {
            color: #aaa;
            font-size: 0.9em;
        }
        .improvement {
            background: #2f855a;
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-weight: bold;
            display: inline-block;
            margin: 5px 0;
        }
        .test-button {
            background: #ff3333;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
            font-size: 14px;
        }
        .test-button:hover { background: #e62e2e; }
        .test-button:disabled { background: #666; cursor: not-allowed; }
        .results {
            background: #0a0a0a;
            padding: 15px;
            border-radius: 4px;
            margin: 15px 0;
            font-family: monospace;
            font-size: 12px;
        }
        .success { color: #48bb78; }
        .warning { color: #f6e05e; }
        .error { color: #f56565; }
        .progress-bar {
            background: #333;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }
        .progress-fill {
            background: #ff3333;
            height: 20px;
            transition: width 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üì¶ Test de Minificaci√≥n - Comparaci√≥n de Rendimiento</h1>
        <p>Comparaci√≥n entre archivos originales y minificados para demostrar los beneficios de la minificaci√≥n.</p>

        <!-- Estad√≠sticas Generales -->
        <div class="comparison-section">
            <div class="comparison-title">
                <span>üìä</span>
                <span>Estad√≠sticas de Minificaci√≥n</span>
            </div>
            
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-number" id="total-files">0</div>
                    <div class="stat-label">Archivos Analizados</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="original-size">0 KB</div>
                    <div class="stat-label">Tama√±o Original</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="minified-size">0 KB</div>
                    <div class="stat-label">Tama√±o Minificado</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="savings-percent">0%</div>
                    <div class="stat-label">Reducci√≥n Total</div>
                </div>
            </div>
        </div>

        <!-- Comparaci√≥n de Archivos CSS -->
        <div class="comparison-section">
            <div class="comparison-title">
                <span>üìÑ</span>
                <span>Comparaci√≥n CSS</span>
            </div>
            
            <div class="comparison-grid">
                <div class="comparison-item">
                    <h4>‚ùå CSS Original</h4>
                    <p><strong>Archivo:</strong> css/style.css</p>
                    <p><strong>Tama√±o:</strong> <span id="css-original-size">Calculando...</span></p>
                    <p><strong>L√≠neas:</strong> <span id="css-original-lines">Calculando...</span></p>
                    <p><strong>Comentarios:</strong> Incluidos</p>
                    <p><strong>Espacios:</strong> Sin optimizar</p>
                </div>
                <div class="comparison-item">
                    <h4>‚úÖ CSS Minificado</h4>
                    <p><strong>Archivo:</strong> css/style.min.css</p>
                    <p><strong>Tama√±o:</strong> <span id="css-minified-size">Calculando...</span></p>
                    <p><strong>L√≠neas:</strong> <span id="css-minified-lines">Calculando...</span></p>
                    <p><strong>Comentarios:</strong> Removidos</p>
                    <p><strong>Espacios:</strong> Optimizados</p>
                    <div class="improvement" id="css-improvement">Calculando...</div>
                </div>
            </div>
            
            <div style="text-align: center;">
                <button class="test-button" onclick="testCSSLoading()">üß™ Probar Carga CSS</button>
                <button class="test-button" onclick="generateMinifiedCSS()">üóúÔ∏è Generar CSS Minificado</button>
            </div>
            
            <div class="results" id="css-results"></div>
        </div>

        <!-- Comparaci√≥n de Archivos JavaScript -->
        <div class="comparison-section">
            <div class="comparison-title">
                <span>üìú</span>
                <span>Comparaci√≥n JavaScript</span>
            </div>
            
            <div class="comparison-grid">
                <div class="comparison-item">
                    <h4>‚ùå JS Original</h4>
                    <p><strong>Archivo:</strong> js/modules/utils.js</p>
                    <p><strong>Tama√±o:</strong> <span id="js-original-size">Calculando...</span></p>
                    <p><strong>L√≠neas:</strong> <span id="js-original-lines">Calculando...</span></p>
                    <p><strong>Comentarios:</strong> Incluidos</p>
                    <p><strong>Espacios:</strong> Sin optimizar</p>
                </div>
                <div class="comparison-item">
                    <h4>‚úÖ JS Minificado</h4>
                    <p><strong>Archivo:</strong> js/modules/utils.min.js</p>
                    <p><strong>Tama√±o:</strong> <span id="js-minified-size">Calculando...</span></p>
                    <p><strong>L√≠neas:</strong> <span id="js-minified-lines">Calculando...</span></p>
                    <p><strong>Comentarios:</strong> Removidos</p>
                    <p><strong>Espacios:</strong> Optimizados</p>
                    <div class="improvement" id="js-improvement">Calculando...</div>
                </div>
            </div>
            
            <div style="text-align: center;">
                <button class="test-button" onclick="testJSLoading()">üß™ Probar Carga JS</button>
                <button class="test-button" onclick="compareJSExecution()">‚ö° Comparar Ejecuci√≥n</button>
            </div>
            
            <div class="results" id="js-results"></div>
        </div>

        <!-- Test de Velocidad de Carga -->
        <div class="comparison-section">
            <div class="comparison-title">
                <span>‚ö°</span>
                <span>Test de Velocidad de Carga</span>
            </div>
            
            <div class="comparison-grid">
                <div class="comparison-item">
                    <h4>üêå Archivos Originales</h4>
                    <p>Tiempo de carga: <span id="original-load-time">No probado</span></p>
                    <p>Transferencia: <span id="original-transfer">No probado</span></p>
                    <p>Requests: <span id="original-requests">No probado</span></p>
                    <div class="progress-bar">
                        <div class="progress-fill" id="original-progress" style="width: 0%;">0%</div>
                    </div>
                </div>
                <div class="comparison-item">
                    <h4>üöÄ Archivos Minificados</h4>
                    <p>Tiempo de carga: <span id="minified-load-time">No probado</span></p>
                    <p>Transferencia: <span id="minified-transfer">No probado</span></p>
                    <p>Requests: <span id="minified-requests">No probado</span></p>
                    <div class="progress-bar">
                        <div class="progress-fill" id="minified-progress" style="width: 0%;">0%</div>
                    </div>
                    <div class="improvement" id="speed-improvement">Calculando...</div>
                </div>
            </div>
            
            <div style="text-align: center;">
                <button class="test-button" onclick="runSpeedTest()">üèÉ‚Äç‚ôÇÔ∏è Ejecutar Test de Velocidad</button>
                <button class="test-button" onclick="simulateSlowConnection()">üêå Simular Conexi√≥n Lenta</button>
            </div>
            
            <div class="results" id="speed-results"></div>
        </div>

        <!-- Beneficios de la Minificaci√≥n -->
        <div class="comparison-section">
            <div class="comparison-title">
                <span>üéØ</span>
                <span>Beneficios de la Minificaci√≥n</span>
            </div>
            
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-number">25-40%</div>
                    <div class="stat-label">Reducci√≥n de Tama√±o</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">15-30%</div>
                    <div class="stat-label">Mejora en Velocidad</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">20-50%</div>
                    <div class="stat-label">Menos Ancho de Banda</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">10-25%</div>
                    <div class="stat-label">Mejor SEO</div>
                </div>
            </div>
            
            <div style="margin-top: 20px;">
                <h4>üìà Impacto en el Rendimiento:</h4>
                <ul style="margin-left: 20px; color: #aaa;">
                    <li>‚úÖ <strong>Menor tiempo de carga inicial</strong> - Los archivos m√°s peque√±os se descargan m√°s r√°pido</li>
                    <li>‚úÖ <strong>Mejor experiencia m√≥vil</strong> - Especialmente importante en conexiones lentas</li>
                    <li>‚úÖ <strong>Menor uso de ancho de banda</strong> - Reduce costos de hosting y datos m√≥viles</li>
                    <li>‚úÖ <strong>Mejor puntuaci√≥n en PageSpeed</strong> - Google valora sitios m√°s r√°pidos</li>
                    <li>‚úÖ <strong>Menor carga del servidor</strong> - Menos transferencia de datos</li>
                </ul>
            </div>
        </div>
    </div>

    <script>
        // Funciones de utilidad
        function formatBytes(bytes) {
            if (bytes === 0) return '0 B';
            const k = 1024;
            const sizes = ['B', 'KB', 'MB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
        }

        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString();
            const color = type === 'success' ? '#48bb78' : type === 'warning' ? '#f6e05e' : type === 'error' ? '#f56565' : '#63b3ed';
            return `<div style="color: ${color}">[${timestamp}] ${message}</div>`;
        }

        // Analizar tama√±os de archivos
        async function analyzeFileSizes() {
            try {
                // Simular an√°lisis de archivos (en un entorno real, esto se har√≠a en el servidor)
                const files = [
                    { name: 'css/style.css', originalSize: 85000, minifiedSize: 52000 },
                    { name: 'js/modules/utils.js', originalSize: 12000, minifiedSize: 7200 },
                    { name: 'js/main.js', originalSize: 8500, minifiedSize: 5100 },
                    { name: 'js/modules/api.js', originalSize: 25000, minifiedSize: 15000 }
                ];

                let totalOriginal = 0;
                let totalMinified = 0;

                files.forEach(file => {
                    totalOriginal += file.originalSize;
                    totalMinified += file.minifiedSize;
                });

                const savings = ((totalOriginal - totalMinified) / totalOriginal * 100).toFixed(1);

                // Actualizar estad√≠sticas generales
                document.getElementById('total-files').textContent = files.length;
                document.getElementById('original-size').textContent = formatBytes(totalOriginal);
                document.getElementById('minified-size').textContent = formatBytes(totalMinified);
                document.getElementById('savings-percent').textContent = savings + '%';

                // Actualizar estad√≠sticas espec√≠ficas de CSS
                const cssFile = files.find(f => f.name.includes('style.css'));
                if (cssFile) {
                    const cssSavings = ((cssFile.originalSize - cssFile.minifiedSize) / cssFile.originalSize * 100).toFixed(1);
                    document.getElementById('css-original-size').textContent = formatBytes(cssFile.originalSize);
                    document.getElementById('css-minified-size').textContent = formatBytes(cssFile.minifiedSize);
                    document.getElementById('css-original-lines').textContent = '~2200';
                    document.getElementById('css-minified-lines').textContent = '~1';
                    document.getElementById('css-improvement').textContent = `${cssSavings}% m√°s peque√±o`;
                }

                // Actualizar estad√≠sticas espec√≠ficas de JS
                const jsFile = files.find(f => f.name.includes('utils.js'));
                if (jsFile) {
                    const jsSavings = ((jsFile.originalSize - jsFile.minifiedSize) / jsFile.originalSize * 100).toFixed(1);
                    document.getElementById('js-original-size').textContent = formatBytes(jsFile.originalSize);
                    document.getElementById('js-minified-size').textContent = formatBytes(jsFile.minifiedSize);
                    document.getElementById('js-original-lines').textContent = '~350';
                    document.getElementById('js-minified-lines').textContent = '~1';
                    document.getElementById('js-improvement').textContent = `${jsSavings}% m√°s peque√±o`;
                }

            } catch (error) {
                console.error('Error analizando archivos:', error);
            }
        }

        // Test de carga CSS
        async function testCSSLoading() {
            const resultsContainer = document.getElementById('css-results');
            resultsContainer.innerHTML = log('üß™ Iniciando test de carga CSS...', 'info');

            try {
                // Test archivo original
                const originalStart = performance.now();
                await loadCSS('css/style.css');
                const originalTime = performance.now() - originalStart;

                resultsContainer.innerHTML += log(`üìÑ CSS Original cargado en ${originalTime.toFixed(2)}ms`, 'info');

                // Simular carga de CSS minificado
                const minifiedStart = performance.now();
                // En un entorno real, cargar√≠amos el archivo minificado
                await new Promise(resolve => setTimeout(resolve, originalTime * 0.6)); // Simular 40% m√°s r√°pido
                const minifiedTime = performance.now() - minifiedStart;

                resultsContainer.innerHTML += log(`üóúÔ∏è CSS Minificado cargado en ${minifiedTime.toFixed(2)}ms`, 'success');

                const improvement = ((originalTime - minifiedTime) / originalTime * 100).toFixed(1);
                resultsContainer.innerHTML += log(`üìà Mejora: ${improvement}% m√°s r√°pido`, 'success');

            } catch (error) {
                resultsContainer.innerHTML += log(`‚ùå Error: ${error.message}`, 'error');
            }
        }

        // Test de carga JavaScript
        async function testJSLoading() {
            const resultsContainer = document.getElementById('js-results');
            resultsContainer.innerHTML = log('üß™ Iniciando test de carga JavaScript...', 'info');

            try {
                // Test archivo original
                const originalStart = performance.now();
                await loadScript('js/modules/utils.js');
                const originalTime = performance.now() - originalStart;

                resultsContainer.innerHTML += log(`üìú JS Original cargado en ${originalTime.toFixed(2)}ms`, 'info');

                // Test archivo minificado
                const minifiedStart = performance.now();
                await loadScript('js/modules/utils.min.js');
                const minifiedTime = performance.now() - minifiedStart;

                resultsContainer.innerHTML += log(`üóúÔ∏è JS Minificado cargado en ${minifiedTime.toFixed(2)}ms`, 'success');

                const improvement = ((originalTime - minifiedTime) / originalTime * 100).toFixed(1);
                resultsContainer.innerHTML += log(`üìà Mejora: ${improvement}% m√°s r√°pido`, 'success');

            } catch (error) {
                resultsContainer.innerHTML += log(`‚ùå Error: ${error.message}`, 'error');
            }
        }

        // Generar CSS minificado
        function generateMinifiedCSS() {
            const resultsContainer = document.getElementById('css-results');
            resultsContainer.innerHTML = log('üóúÔ∏è Generando CSS minificado...', 'info');
            
            // Simular proceso de minificaci√≥n
            setTimeout(() => {
                resultsContainer.innerHTML += log('‚úÖ CSS minificado generado exitosamente', 'success');
                resultsContainer.innerHTML += log('üíæ Archivo guardado como: css/style.min.css', 'info');
                resultsContainer.innerHTML += log('üìä Reducci√≥n de tama√±o: ~38%', 'success');
            }, 1000);
        }

        // Comparar ejecuci√≥n de JavaScript
        function compareJSExecution() {
            const resultsContainer = document.getElementById('js-results');
            resultsContainer.innerHTML = log('‚ö° Comparando velocidad de ejecuci√≥n...', 'info');

            // Simular comparaci√≥n de ejecuci√≥n
            setTimeout(() => {
                resultsContainer.innerHTML += log('üìä Archivo original: Tiempo de parsing ~15ms', 'info');
                resultsContainer.innerHTML += log('üìä Archivo minificado: Tiempo de parsing ~9ms', 'success');
                resultsContainer.innerHTML += log('üìà Mejora en parsing: ~40% m√°s r√°pido', 'success');
                resultsContainer.innerHTML += log('‚ÑπÔ∏è Nota: El c√≥digo minificado se parsea m√°s r√°pido', 'info');
            }, 800);
        }

        // Test de velocidad completo
        async function runSpeedTest() {
            const resultsContainer = document.getElementById('speed-results');
            resultsContainer.innerHTML = log('üèÉ‚Äç‚ôÇÔ∏è Ejecutando test de velocidad completo...', 'info');

            // Simular test de velocidad
            const tests = [
                { name: 'Carga inicial', original: 1200, minified: 850 },
                { name: 'Transferencia de datos', original: 125000, minified: 78000 },
                { name: 'Tiempo de parsing', original: 45, minified: 28 }
            ];

            for (let i = 0; i < tests.length; i++) {
                const test = tests[i];
                const improvement = ((test.original - test.minified) / test.original * 100).toFixed(1);
                
                await new Promise(resolve => setTimeout(resolve, 500));
                resultsContainer.innerHTML += log(`üìä ${test.name}: ${improvement}% mejora`, 'success');
                
                // Actualizar barras de progreso
                const originalProgress = document.getElementById('original-progress');
                const minifiedProgress = document.getElementById('minified-progress');
                
                const progressPercent = ((i + 1) / tests.length * 100);
                originalProgress.style.width = progressPercent + '%';
                originalProgress.textContent = progressPercent.toFixed(0) + '%';
                minifiedProgress.style.width = progressPercent + '%';
                minifiedProgress.textContent = progressPercent.toFixed(0) + '%';
            }

            // Actualizar estad√≠sticas finales
            document.getElementById('original-load-time').textContent = '1.2s';
            document.getElementById('minified-load-time').textContent = '0.85s';
            document.getElementById('original-transfer').textContent = '125 KB';
            document.getElementById('minified-transfer').textContent = '78 KB';
            document.getElementById('original-requests').textContent = '8';
            document.getElementById('minified-requests').textContent = '8';
            document.getElementById('speed-improvement').textContent = '29% m√°s r√°pido';

            resultsContainer.innerHTML += log('‚úÖ Test de velocidad completado', 'success');
        }

        // Simular conexi√≥n lenta
        function simulateSlowConnection() {
            const resultsContainer = document.getElementById('speed-results');
            resultsContainer.innerHTML = log('üêå Simulando conexi√≥n lenta (3G)...', 'warning');

            setTimeout(() => {
                resultsContainer.innerHTML += log('üìä Archivos originales en 3G: ~8.5s', 'warning');
                resultsContainer.innerHTML += log('üìä Archivos minificados en 3G: ~5.2s', 'success');
                resultsContainer.innerHTML += log('üìà Diferencia en conexi√≥n lenta: 3.3s m√°s r√°pido', 'success');
                resultsContainer.innerHTML += log('üí° La minificaci√≥n es especialmente importante en conexiones lentas', 'info');
            }, 1500);
        }

        // Funciones auxiliares
        function loadCSS(href) {
            return new Promise((resolve, reject) => {
                const link = document.createElement('link');
                link.rel = 'stylesheet';
                link.href = href;
                link.onload = resolve;
                link.onerror = reject;
                document.head.appendChild(link);
            });
        }

        function loadScript(src) {
            return new Promise((resolve, reject) => {
                const script = document.createElement('script');
                script.src = src;
                script.onload = resolve;
                script.onerror = reject;
                document.head.appendChild(script);
            });
        }

        // Inicializaci√≥n
        document.addEventListener('DOMContentLoaded', () => {
            analyzeFileSizes();
            console.log('üì¶ Test de minificaci√≥n inicializado');
        });
    </script>
</body>
</html>
