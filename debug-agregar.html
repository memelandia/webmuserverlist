<!DOCTYPE html>
<html lang="es">
<head>
    <link rel="apple-touch-icon" sizes="180x180" href="img/apple-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="img/favicon-16x16.png">
    <link rel="icon" type="image/x-icon" href="img/favicon.ico">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DEBUG Agregar - MuServerList</title> 
    <meta name="description" content="Debug version of agregar.html">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"/>
    <link rel="stylesheet" href="css/style.css">
    <style>
        .debug-panel {
            position: fixed;
            top: 10px;
            right: 10px;
            width: 400px;
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 12px;
            max-height: 500px;
            overflow-y: auto;
            z-index: 9999;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }
        .debug-header {
            background: #4a5568;
            margin: -15px -15px 10px -15px;
            padding: 10px 15px;
            font-weight: bold;
            border-radius: 8px 8px 0 0;
        }
        .debug-log {
            white-space: pre-wrap;
            word-break: break-word;
        }
        .debug-controls {
            margin-bottom: 10px;
        }
        .debug-controls button {
            background: #4299e1;
            color: white;
            border: none;
            padding: 5px 10px;
            margin: 2px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 11px;
        }
        .debug-controls button:hover {
            background: #3182ce;
        }
    </style>
</head>
<body id="page-agregar">    
    <!-- Panel de Debug -->
    <div class="debug-panel">
        <div class="debug-header">üêõ DEBUG PANEL - Agregar Servidor</div>
        <div class="debug-controls">
            <button onclick="clearDebugLog()">üóëÔ∏è Limpiar</button>
            <button onclick="toggleDebugPanel()">üëÅÔ∏è Ocultar</button>
            <button onclick="exportLogs()">üìã Exportar</button>
        </div>
        <div id="debug-log" class="debug-log">Iniciando debug...\n</div>
    </div>

    <header class="main-header">
        <nav class="main-nav container">
            <a href="index.html" class="logo-container">
                <img src="img/logo.png" alt="MuServerList Logo" class="logo-img">
                <span class="logo-text">MuServer<span>List</span></span>
            </a>
            <ul class="nav-menu">
                <li><a href="index.html">Inicio</a></li>
                <li><a href="explorar.html">Explorar</a></li>
                <li><a href="ranking.html">Ranking</a></li>
                <li><a href="calendario.html">Calendario</a></li>
            </ul>
            <div class="nav-actions" id="auth-section"></div>
            <button id="mobile-menu-btn" class="mobile-menu-btn"><i class="fa-solid fa-bars"></i></button>
        </nav>
    </header>

    <main class="container page-container">
        <div class="page-header">
            <h1><i class="fa-solid fa-plus-circle"></i> DEBUG: Publica tu Servidor</h1>
            <p>Versi√≥n de debug para identificar el problema de subida.</p>
        </div>

        <div class="form-container" id="add-server-container">
            <div id="auth-required-message" class="hidden widget" style="text-align: center;">
                <h2><i class="fa-solid fa-lock"></i> Acceso Restringido</h2>
                <p>Debes <a href="#" id="login-link">iniciar sesi√≥n</a> para publicar un servidor.</p>
            </div>

            <form id="add-server-form" class="hidden">
                
                <h4><i class="fa-solid fa-server"></i> Informaci√≥n Principal</h4>
                <div class="form-group">
                    <label for="name">Nombre del Servidor</label>
                    <input type="text" id="name" name="name" required placeholder="Servidor de Debug" value="Servidor de Debug">
                </div>
                <div class="form-group">
                    <label for="description">Descripci√≥n</label>
                    <textarea id="description" name="description" rows="4" placeholder="Servidor para debug...">Servidor para debug</textarea>
                </div>

                <h4><i class="fa-solid fa-cogs"></i> Configuraci√≥n del Juego</h4>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="version">Versi√≥n</label>
                        <select id="version" name="version" required>
                            <option value="Season 18" selected>Season 18</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="type">Tipo de Servidor</label>
                        <select id="type" name="type" required>
                            <option value="Medium" selected>Medium</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="configuration">Configuraci√≥n</label>
                        <select id="configuration" name="configuration" required>
                            <option value="Custom" selected>Custom</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="exp_rate">Experiencia (s√≥lo n√∫mero)</label>
                        <input type="number" id="exp_rate" name="exp_rate" placeholder="500" value="500">
                    </div>
                </div>
                <div class="form-group">
                    <label for="drop_rate">Drop Rate (s√≥lo n√∫mero)</label>
                    <input type="number" id="drop_rate" name="drop_rate" placeholder="30" value="30">
                </div>
                <div class="form-group">
                    <label for="reset_info">Informaci√≥n del Reset</label>
                    <input type="text" id="reset_info" name="reset_info" placeholder="Nivel 400" value="Nivel 400">
                </div>

                <h4><i class="fa-solid fa-images"></i> Medios Gr√°ficos</h4>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="logo-file">Logo del Servidor</label>
                        <input type="file" id="logo-file" name="logo-file" class="file-input" accept="image/png, image/jpeg, image/gif">
                        <small>Recomendado: 200x200px. M√°ximo 2MB.</small>
                    </div>
                    <div class="form-group">
                         <label for="banner-file">Banner del Servidor</label>
                         <input type="file" id="banner-file" name="banner-file" class="file-input" accept="image/png, image/jpeg">
                         <small>Recomendado: 1200x300px. M√°ximo 2MB.</small>
                    </div>
                </div>
                <div class="form-group">
                    <label for="gallery-files">Galer√≠a de Im√°genes (M√°x. 6)</label>
                    <input type="file" id="gallery-files" name="gallery-files-input" class="file-input" accept="image/png, image/jpeg" multiple>
                    <small>Selecciona hasta 6 im√°genes para la galer√≠a. M√°ximo 2MB por imagen.</small>
                </div>

                <h4><i class="fa-solid fa-link"></i> Enlaces Externos</h4>
                 <div class="form-grid">
                    <div class="form-group">
                        <label for="website_url">P√°gina Web</label>
                        <input type="url" id="website_url" name="website_url" placeholder="https://..." required value="https://debug.com">
                    </div>
                    <div class="form-group">
                        <label for="discord_url">Enlace de Discord</label>
                        <input type="url" id="discord_url" name="discord_url" placeholder="https://discord.gg/..." value="https://discord.gg/debug">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="opening_date">Fecha y Hora de Apertura (Opcional)</label>
                    <input type="datetime-local" id="opening_date" name="opening_date">
                    <small>Si tu servidor a√∫n no ha abierto, indica cu√°ndo ser√° la apertura.</small>
                </div>

                <div id="form-feedback" class="feedback-message"></div>
                
                <button type="submit" class="btn btn-primary btn-lg" id="submit-btn" style="width:100%; margin-top: 2rem;">
                    <i class="fa-solid fa-paper-plane"></i> DEBUG: Enviar Servidor
                </button>
            </form>
        </div>
    </main>
    
    <footer class="main-footer">
        <div class="footer-content container">
            <div class="footer-column">
                <p class="footer-description">DEBUG VERSION - MuServerList</p>
            </div>
        </div>
        <div class="footer-bottom">
            <p>¬© 2024 MuServerList DEBUG. Todos los derechos reservados.</p>
        </div>
    </footer>

    <div id="auth-modal-placeholder"></div>
   
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="js/supabase-init.js"></script>
    
    <script>
        // Sistema de debug logging
        let debugLogs = [];
        let debugVisible = true;
        
        function addDebugLog(message, type = 'info') {
            const timestamp = new Date().toISOString();
            const prefix = type === 'error' ? '‚ùå' : type === 'success' ? '‚úÖ' : type === 'warning' ? '‚ö†Ô∏è' : '‚ÑπÔ∏è';
            const logEntry = `[${timestamp}] ${prefix} ${message}`;
            debugLogs.push(logEntry);
            
            const debugLog = document.getElementById('debug-log');
            if (debugLog) {
                debugLog.textContent += logEntry + '\n';
                debugLog.scrollTop = debugLog.scrollHeight;
            }
        }
        
        function clearDebugLog() {
            debugLogs = [];
            document.getElementById('debug-log').textContent = 'Logs limpiados...\n';
        }
        
        function toggleDebugPanel() {
            const panel = document.querySelector('.debug-panel');
            debugVisible = !debugVisible;
            panel.style.display = debugVisible ? 'block' : 'none';
        }
        
        function exportLogs() {
            const logsText = debugLogs.join('\n');
            navigator.clipboard.writeText(logsText).then(() => {
                addDebugLog('Logs copiados al portapapeles', 'success');
            }).catch(() => {
                addDebugLog('No se pudieron copiar los logs', 'error');
            });
        }
        
        // Sobrescribir console para capturar todos los logs
        const originalLog = console.log;
        const originalError = console.error;
        const originalWarn = console.warn;
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            addDebugLog('LOG: ' + args.join(' '), 'info');
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            addDebugLog('ERROR: ' + args.join(' '), 'error');
        };
        
        console.warn = function(...args) {
            originalWarn.apply(console, args);
            addDebugLog('WARN: ' + args.join(' '), 'warning');
        };
        
        // Hacer funciones disponibles globalmente
        window.clearDebugLog = clearDebugLog;
        window.toggleDebugPanel = toggleDebugPanel;
        window.exportLogs = exportLogs;
        
        addDebugLog('Sistema de debug inicializado', 'success');
        addDebugLog('Esta p√°gina simula exactamente agregar.html', 'info');
    </script>
    
    <!-- EXACTAMENTE EL MISMO SCRIPT QUE AGREGAR.HTML -->
    <script type="module" src="js/main-app.js"></script>
</body>
</html>
